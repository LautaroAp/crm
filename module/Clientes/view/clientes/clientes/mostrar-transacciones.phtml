<!-- <script src="/js/ajax.js"></script> -->
<script>
$(document).ready(function() {
    $('#tabla_eventos').DataTable({
        "order": [0, 'desc'],

        "language": {
            "url": "/json/spanish.json"
        }
    });
});
</script>

<table id="tabla_eventos" class="display">
    <thead>
        <tr>
            <th class="" id="fila">Fecha</th>
            <th class="">Responsable</th>
            <th class="">Tipo</th>
            <th class="detalle-width">Detalle</th>
            <th class=""></th>
        </tr>
    </thead>
    <tbody id="cuerpo_eventos" role="button" class="">
        <?php foreach ($transacciones as $transaccion) :
            $idTransaccion = $transaccion->getId();
            $tipoTransaccion = $transaccion->getTipo();
        ?>
        <tr id="<?= $transaccion->getId() ?>" class="vpEvento">
            <td id="<?= $transaccion->getId() ?>">
                <?php
                if (!is_null($transaccion->getFecha_transaccion())) {
                    echo ($transaccion->getFecha_transaccion()->format('Y/m/d'));
                }
                ?></td>
            <td> <?php echo ($transaccion->getResponsable()->getUsuario()); ?> </td>
            <td id="<?= $transaccion->getId() ?>" class="">
                <?php
                if (!is_null($transaccion->getTipo())) {
                    echo (ucfirst($transaccion->getTipo()));
                } else {
                    echo ('No definido');
                }
                ?></td>
            <td><?= $transaccion->getDescripcion() ?></td>
            <td id="<?= $transaccion->getId() ?>" class="">
                <a href="<?= $this->url($transaccion->getTipo().'/pdf', ['id' => (int)$transaccion->getId()]) ?>"
                 type="button" class="btn btn-default btn-sm">
                    <span class="glyphicon glyphicon-file"></span>
                </a>
                <a href="<?= $this->url($transaccion->getTipo().'/editar', ['id' => (int)$transaccion->getId()]) ?>"
                 type="button" class="btn btn-default btn-sm">
                    <span class="glyphicon glyphicon-pencil"></span>
                </a>
            </td>
            <?php if (ucfirst($transaccion->getTipo())!="Remito"){ ?>
                <td id="<?= $transaccion->getId() ?>" class="">
                    <a href="<?= $this->url($transaccion->getTipo().'/editar', ['id' => (int)$transaccion->getId()]) ?>"
                    type="button" class="btn btn-default btn-sm" 
                    >
                        <span class="glyphicon glyphicon-pencil"></span>
                    </a>
                </td>
            <?php } else{ ?>
                <td id="<?= $transaccion->getId() ?>">
                <div  class="dropdown">
                     <ul class="nav navbar-nav navbar-menu-font"> 
                        <button class="btn btn-default btn-sm dropdown-toggle" type="button" data-toggle="dropdown" id="dropdownRemito">
                        <span class="glyphicon glyphicon-check"></span></button>
                        <ul class="dropdown-menu"  aria-labelledby="dropdownRemito">
                            <li><a type="button" role="button" id="<?= $transaccion->getId() ?>" 
                            onclick="cambiarEstado('ANULADO', event)">
                            Anulado</a></li>
                            <li><a type="button" role="button" id="<?= $transaccion->getId() ?>" 
                            onclick="cambiarEstado('A_ENTREGAR', event)">
                            A entregar</a></li>
                            <li><a type="button" role="button" id="<?= $transaccion->getId() ?>" 
                            onclick="cambiarEstado('ENTREGADO', event)">
                            Entregado</a></li>
                            <li><a type="button" role="button" id="<?= $transaccion->getId() ?>" 
                            onclick="cambiarEstado('CONFORMADO', event)">
                            Conformado</a></li>
                        </ul>
                    </ul>
                </div>
                </td>
                
            <?php } ?>
            
        </tr>
        <?php endforeach; ?>
    </tbody>
</table>